.. _micrortpsgen_label:

MicroRTPSGen
============

*MicroRTPSGen* is a Java application used to generate source code for the *eProsima Micro RTPS* software.


This tool is able to generate from a given IDL specification file, the C struct associated with the
Topic, as well as, the serialization and deserialization methods. As an example of the powerful of
this tool, the following shows the source code generated from the ShapeDemo IDL file.

::

    // ShapeDemo.idl

    struct ShapeType {
        @ket string color;
        long x;
        long y;
        long shapesize;
    };

Will generate:

.. code-block:: C

    /*!
    * @file Shape.h
    * This header file contains the declaration of the described types in the IDL file.
    *
    * This file was generated by the tool gen.
    */

    #ifndef _Shape_H_
    #define _Shape_H_

    #include <string.h>
    #include <stdlib.h>
    #include <microcdr/microcdr.h>

    /*!
    * @brief This class represents the structure ShapeType defined by the user in the IDL file.
    * @ingroup SHAPE
    */
    typedef struct ShapeType
    {
        char* m_color;
        int32_t m_x;
        int32_t m_y;
        int32_t m_shapesize;
    }ShapeType;

    bool serialize_Shape_topic(MicroBuffer* writer, const AbstractTopic* topic_structure)
    {
        ShapeType* topic = (ShapeType*) topic_structure->topic;
        serialize_uint32_t(writer, strlen(topic->m_color) + 1);
        serialize_array_char(writer, topic->m_color, strlen(topic->m_color) + 1);
        serialize_int32_t(writer, topic->m_x);
        serialize_int32_t(writer, topic->m_y);
        serialize_int32_t(writer, topic->m_shapesize);

        return true;
    }

    bool deserialize_Shape_topic(MicroBuffer* reader, AbstractTopic* topic_structure)
    {
        ShapeType* topic = malloc(sizeof(ShapeType));
        uint32_t size = 0;
        deserialize_uint32_t(reader, &size);
        topic->m_color = malloc(size);
        deserialize_array_char(reader, topic->m_color, size);
        deserialize_int32_t(reader, &topic->m_x);
        deserialize_int32_t(reader, &topic->m_y);
        deserialize_int32_t(reader, &topic->m_shapesize);

        return true;
    }

Installation
------------

For use *MicroRTPSGen* you have to follow the next steps:

1. Install its dependencies:

    1.1 `Gradle <https://gradle.org/install/>`_.

    1.2 `Java JDK <http://www.oracle.com/technetwork/java/javase/downloads/index.html>`_.

2. Clone the code from the GitHub repository. ::

    $ git clone --recursive https://github.com/eProsima/micro-RTPS-gen.git
    $ cd micro-RTPS-gen

3. Build the code with Gradle. ::

    $ cd micro-RTPS-gen
    $ gragle build

Usage
-----

::

    $ ./scripts/micrortpsgen -d <output dir> <file.idl>

At the present time, *MicroRTPSGen* only supports Structs composed of integer types and string type, even though it is planned to enhance the capabilities of the *MicroRTPSGen* tool in a near
future.
